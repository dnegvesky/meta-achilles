From ea0e2b97bffff356415d7755b213eec44622420b Mon Sep 17 00:00:00 2001
From: Dan Negvesky <dnegvesky@reflexces.com>
Date: Tue, 3 Mar 2020 16:52:48 -0500
Subject: [PATCH 1/1] add achilles support in board/reflexces/achilles

Signed-off-by: Dan Negvesky <dnegvesky@reflexces.com>
---
 board/reflexces/achilles/Kconfig             | 18 ++++++++
 board/reflexces/achilles/MAINTAINERS         |  6 +++
 board/reflexces/achilles/Makefile            |  5 +++
 board/reflexces/achilles/fit_kernel_emmc.its | 44 ++++++++++++++++++++
 board/reflexces/achilles/fit_spl_fpga.its    | 38 +++++++++++++++++
 board/reflexces/achilles/fit_uboot.its       | 33 +++++++++++++++
 board/reflexces/achilles/socfpga.c           |  6 +++
 7 files changed, 150 insertions(+)
 create mode 100644 board/reflexces/achilles/Kconfig
 create mode 100644 board/reflexces/achilles/MAINTAINERS
 create mode 100644 board/reflexces/achilles/Makefile
 create mode 100644 board/reflexces/achilles/fit_kernel_emmc.its
 create mode 100644 board/reflexces/achilles/fit_spl_fpga.its
 create mode 100644 board/reflexces/achilles/fit_uboot.its
 create mode 100644 board/reflexces/achilles/socfpga.c

diff --git a/board/reflexces/achilles/Kconfig b/board/reflexces/achilles/Kconfig
new file mode 100644
index 0000000000..84670315f9
--- /dev/null
+++ b/board/reflexces/achilles/Kconfig
@@ -0,0 +1,18 @@
+if TARGET_SOCFPGA_ARRIA10_ACHILLES
+
+config SYS_CPU
+	default "armv7"
+
+config SYS_BOARD
+	default "socfpga_arria10"
+
+config SYS_VENDOR
+	default "reflexces"
+
+config SYS_SOC
+	default "socfpga_arria10"
+
+config SYS_CONFIG_NAME
+	default "socfpga_arria10"
+
+endif
diff --git a/board/reflexces/achilles/MAINTAINERS b/board/reflexces/achilles/MAINTAINERS
new file mode 100644
index 0000000000..d2a7c11ba9
--- /dev/null
+++ b/board/reflexces/achilles/MAINTAINERS
@@ -0,0 +1,6 @@
+SOCFPGA BOARD
+M:	Dan Negvesky <dnegvesky@reflexces.org>
+S:	Maintained
+F:	board/reflexces/achilles/
+F:	include/configs/socfpga_arria10_achilles.h
+F:	configs/socfpga_arria10_achilles_defconfig
diff --git a/board/reflexces/achilles/Makefile b/board/reflexces/achilles/Makefile
new file mode 100644
index 0000000000..80d0004346
--- /dev/null
+++ b/board/reflexces/achilles/Makefile
@@ -0,0 +1,5 @@
+# SPDX-License-Identifier: GPL-2.0
+#
+# Copyright (C) 2015 Altera Corporation <www.altera.com>
+
+obj-y	:= socfpga.o
diff --git a/board/reflexces/achilles/fit_kernel_emmc.its b/board/reflexces/achilles/fit_kernel_emmc.its
new file mode 100644
index 0000000000..b1dabb1c9e
--- /dev/null
+++ b/board/reflexces/achilles/fit_kernel_emmc.its
@@ -0,0 +1,44 @@
+// SPDX-License-Identifier: GPL-2.0
+/*
+ * Copyright (C) 2020 REFLEX CES <www.reflexces.com>
+ *
+ */
+
+/dts-v1/;
+
+/ {
+	description = "FIT image with kernel and DTB";
+	#address-cells = <1>;
+
+	images {
+		kernel {
+			description = "Linux Kernel";
+			data = /incbin/("../../../Image");
+			type = "kernel";
+			os = "linux";
+			arch = "arm";
+			compression = "none";
+			load = <0x8000>;
+			entry = <0x8000>;
+		};
+
+		fdt {
+			description = "Linux DTB";
+			data = /incbin/("../../../socfpga_arria10_achilles_emmc.dtb");
+			type = "flat_dt";
+			os = "linux";
+			arch = "arm";
+			compression = "none";
+
+		};
+	};
+
+	configurations {
+		default = "conf";
+		conf {
+			description = "Linux boot configuration";
+			kernel = "kernel";
+			fdt = "fdt";
+		};
+	};
+};
diff --git a/board/reflexces/achilles/fit_spl_fpga.its b/board/reflexces/achilles/fit_spl_fpga.its
new file mode 100644
index 0000000000..c19ffe4167
--- /dev/null
+++ b/board/reflexces/achilles/fit_spl_fpga.its
@@ -0,0 +1,38 @@
+// SPDX-License-Identifier: GPL-2.0
+ /*
+ * Copyright (C) 2019 Intel Corporation <www.intel.com>
+ *
+ */
+
+/dts-v1/;
+
+/ {
+	description = "FIT image with FPGA bistream";
+	#address-cells = <1>;
+
+	images {
+		fpga-periph-1 {
+			description = "FPGA peripheral bitstream";
+			data = /incbin/("../../../achilles_ghrd.periph.rbf");
+			type = "fpga";
+			arch = "arm";
+			compression = "none";
+		};
+
+		fpga-core-1 {
+			description = "FPGA core bitstream";
+			data = /incbin/("../../../achilles_ghrd.core.rbf");
+			type = "fpga";
+			arch = "arm";
+			compression = "none";
+		};
+	};
+
+	configurations {
+		default = "config-1";
+		config-1 {
+			description = "Boot with FPGA early IO release config";
+			fpga = "fpga-periph-1", "fpga-core-1";
+		};
+	};
+};
diff --git a/board/reflexces/achilles/fit_uboot.its b/board/reflexces/achilles/fit_uboot.its
new file mode 100644
index 0000000000..d42382da1b
--- /dev/null
+++ b/board/reflexces/achilles/fit_uboot.its
@@ -0,0 +1,33 @@
+// SPDX-License-Identifier: GPL-2.0
+ /*
+ * Copyright (C) 2020 REFLEX CES <www.reflexces.com>
+ *
+ */
+
+/dts-v1/;
+
+/ {
+	description = "FIT image with boot binaries";
+	#address-cells = <1>;
+
+	images {
+		uboot {
+			description = "U-Boot (32-bit)";
+			data = /incbin/("../../../u-boot-dtb.bin");
+			type = "standalone";
+			os = "U-Boot";
+			arch = "arm";
+			compression = "none";
+			load = <0x01000040>;
+			entry = <0x01000040>;
+		};
+	};
+
+	configurations {
+		default = "conf";
+		conf {
+			description = "REFLEX CES Achilles SoM";
+			loadables = "uboot";
+		};
+	};
+};
diff --git a/board/reflexces/achilles/socfpga.c b/board/reflexces/achilles/socfpga.c
new file mode 100644
index 0000000000..4c466cb944
--- /dev/null
+++ b/board/reflexces/achilles/socfpga.c
@@ -0,0 +1,6 @@
+// SPDX-License-Identifier: GPL-2.0
+/*
+ * Copyright (C) 2015 Altera Corporation <www.altera.com>
+ */
+
+#include <common.h>
-- 
2.17.1

